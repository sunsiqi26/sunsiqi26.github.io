---
weight: 4
title: "Paper Reading-NPM"
date: 2022-06-14T21:57:40+08:00
lastmod: 2022-06-15T16:45:40+08:00
draft: false
author: "siqi"
description: "NPM生态中的弃用机制研究"
images: []

tags: ["npm", "deprecation"]
categories: ["Paper"]

lightgallery: true

toc:
  auto: true
---
NPM生态中的弃用机制研究
<!--more-->


> *原文标题：Deprecation of Packages and Releases in Software Ecosystems: A Case Study on NPM
>
> *原文作者：Cogo F R, Oliva G A, Hassan A E.*
>
> *原文链接：https://ieeexplore.ieee.org/abstract/document/9351569/*
>
> *发表期刊：TSE'22*



## 简介
当客户端决定继续使用已弃用的版本时可能会引入风险，但先前的文献并未研究软件生态系统中弃用机制的基本原理。论文研究了npm生态系统中的弃用情况，分析了弃用的原因、对用户的影响及应对方案。

## 数据收集
首先，从package.json中收集npm包元数据(版本号、时间戳、依赖项、弃用信息)，收集了截止2019年5月的全部包。然后，对每个包的相邻包版本进行排序，确定相邻版本号变化原因。最后，分析包依赖关系。

## 发现
- RQ1: 发布弃用的频率？
  - 3.7%的npm包至少有一个弃用的版本，其中66%的包被完全弃用（所有版本都标记为弃用），在部分弃用（一些版本标记为弃用）的包中69%有不止一个弃用版本。
  - 31%的部分弃用包没有替换版本，其中65%的此类弃用包维护被放弃或被取代。
  - 退出是包弃用的最常见的原因（49%），漏洞是版本弃用的最常见的原因（63%）。近三分之二的弃用消息报告包或版本的弃用的原因。总结如下：退出(例如，包的开发不再在npm中维护)、超越（例如，不弃用的版本被更新的、改进的版本取代）、缺陷（例如，发现某个功能有问题）、测试（例如，包仅为测试目的而发布）和不兼容。
- RQ2: 弃用的版本在客户端采用的情况如何
  - 直接采用弃用版本(package.json中指定的依赖)
    - 27%的客户端包直接采用至少一个已弃用的版本
    - 小部分弃用版本被客户端包大量采用，前40个流行的弃用版本占所有弃用版本采用的一半以上
    - 所有流行的弃用版本都有声明替代包或迁移版本，简化了从此类弃用版本的迁移
  - 过渡性地采用不赞成使用的版本
    - 54%的所有客户端软件包过渡采用至少一个已弃用的版本
    - 90%的过渡采用最深的依赖深度不大于6
    - 每四个直接采用中会导致至少一个(中位数)传递采用已弃用的版本

## 讨论
- 完善弃用机制
  - 鼓励开发者提供更有意义的弃用消息：告知弃用的原因、声明替换版本、提供指南文档
  - 以交互方式提供弃用的上下文信息，有助于用户包管理
  - 定期警告客户端采用弃用版本
  - 提供内置功能，用于评估已弃用的提供程序版本的传递采用
  - 当较旧的非弃用版本可用时，弃用机制应防止隐式采用弃用版本
- 弃用版本的影响
  - 版本弃用在被部分开发者滥用 
  - 客户端包应考虑功能、漏洞、迁移工作量等因素来决定选择补丁降级还是更新
  